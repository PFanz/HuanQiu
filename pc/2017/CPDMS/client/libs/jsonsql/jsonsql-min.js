var jsonsql={query:function(r,e){var s=r.match(/^(select)\s+([a-z0-9_\,\.\s\*]+)\s+from\s+([a-z0-9_\.]+)(?: where\s+\((.+)\))?\s*(?:order\sby\s+([a-z0-9_\,]+))?\s*(asc|desc|ascnum|descnum)?\s*(?:limit\s+([0-9_\,]+))?/i),o={fields:s[2].replace(" ","").split(","),from:s[3].replace(" ",""),where:void 0==s[4]?"true":s[4],orderby:void 0==s[5]?[]:s[5].replace(" ","").split(","),order:void 0==s[6]?"asc":s[6],limit:void 0==s[7]?[]:s[7].replace(" ","").split(",")};return this.parse(e,o)},parse:function(r,e){var s={fields:["*"],from:"json",where:"",orderby:[],order:"asc",limit:[]};for(i in e)s[i]=e[i];var o=[];return o=this.returnFilter(r,s),o=this.returnOrderBy(o,s.orderby,s.order),o=this.returnLimit(o,s.limit)},returnFilter:function(json,jsonsql_o){var jsonsql_scope=eval(jsonsql_o.from),jsonsql_result=[],jsonsql_rc=0;""==jsonsql_o.where&&(jsonsql_o.where="true");for(var jsonsql_i in jsonsql_scope)with(jsonsql_scope[jsonsql_i])eval(jsonsql_o.where)&&(jsonsql_result[jsonsql_rc++]=this.returnFields(jsonsql_scope[jsonsql_i],jsonsql_o.fields));return jsonsql_result},returnFields:function(r,e){if(0==e.length&&(e=["*"]),"*"==e[0])return r;var s={};for(var o in e)s[e[o]]=r[e[o]];return s},returnOrderBy:function(result,orderby,order){return 0==orderby.length?result:(result.sort(function(a,b){switch(order.toLowerCase()){case"desc":return eval("a."+orderby[0]+" < b."+orderby[0])?1:-1;case"asc":return eval("a."+orderby[0]+" > b."+orderby[0])?1:-1;case"descnum":return eval("a."+orderby[0]+" - b."+orderby[0]);case"ascnum":return eval("b."+orderby[0]+" - a."+orderby[0])}}),result)},returnLimit:function(r,e){switch(e.length){case 0:return r;case 1:return r.splice(0,e[0]);case 2:return r.splice(e[0]-1,e[1])}}};